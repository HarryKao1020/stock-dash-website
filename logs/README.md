# 日誌目錄說明

本目錄用於存放 `update_cache.py` 腳本的執行日誌。

## 日誌文件命名規則

- **格式**: `YYYYMMDDHHMM_log.txt`
- **範例**: `202512290730_log.txt` (2025年12月29日 07:30 執行)
- **自動清理**: 超過 7 天的舊日誌會自動刪除

## 日誌內容

每次執行會記錄：
- ✅ **更新日期和時間**: 精確記錄執行的年月日和星期
- ✅ **日誌檔名**: 當次執行的日誌檔案名稱
- ✅ **舊日誌清理**: 自動刪除 7 天前的日誌記錄
- ✅ **成功更新的項目清單**: 顯示所有成功下載並快取的資料項目（共 20 項）
- ✅ **失敗項目**: 如有失敗會特別標記
- ✅ **快取大小**: 記錄 cache 目錄的總大小
- ✅ **執行時間**: 記錄整個更新流程耗時

## 日誌格式

```
2025-12-29 07:30:01 - INFO - 🔄 FinLab 快取更新開始
2025-12-29 07:30:01 - INFO - ⏰ 開始時間: 2025-12-29 07:30:01
2025-12-29 07:30:01 - INFO - 📅 更新日期: 2025年12月29日 Sunday
2025-12-29 07:30:01 - INFO - 📝 日誌檔案: 202512290730_log.txt
2025-12-29 07:30:01 - INFO - 🧹 檢查並清理舊日誌...
2025-12-29 07:30:01 - INFO - 🗑️  已刪除舊日誌: 202512220730_log.txt
2025-12-29 07:30:01 - INFO - ✅ 共清理 2 個舊日誌檔案（超過 7 天）
...
2025-12-29 07:31:02 - INFO - ✅ 成功更新項目:
2025-12-29 07:31:02 - INFO -    - 收盤價
2025-12-29 07:31:02 - INFO -    - 開盤價
...
```

## 查看日誌

```bash
# 查看最新的日誌（按時間排序）
ls -lt logs/*_log.txt | head -5

# 查看今天的日誌
cat logs/$(date +%Y%m%d)*_log.txt

# 查看最新一次執行的日誌
cat $(ls -t logs/*_log.txt | head -1)

# 查看特定日期的更新記錄（例: 2025-12-29）
cat logs/202512290730_log.txt

# 查看所有成功更新的項目
grep "成功更新項目" logs/*_log.txt -A 20

# 查看是否有失敗項目
grep "失敗" logs/*_log.txt

# 統計日誌數量
ls logs/*_log.txt | wc -l
```

## 日誌管理

✅ **自動清理**: 腳本會自動刪除 7 天前的日誌，無需手動管理

如需調整保留天數，修改 [scripts/update_cache.py](../scripts/update_cache.py) 中的：
```python
cleanup_old_logs(days=7)  # 改成需要的天數
```

手動清理所有日誌：
```bash
rm logs/*_log.txt
```
